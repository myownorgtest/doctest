<!DOCTYPE html>

<html lang="en">
<head>
	<meta charset="utf-8">
	<title>Azure Storage SDK Index</title>

	<!--[if lt IE 9]>
	<script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
	<![endif]-->
	<link type="text/css" rel="stylesheet" href="styles/sunlight.default.css">

	<link type="text/css" rel="stylesheet" href="styles/site.cerulean.css">

</head>

<body>
<div class="container-fluid">
	<div class="navbar navbar-fixed-top navbar-inverse">
		<div class="navbar-inner">
			<a class="brand" href="index.html">Azure Storage SDK</a>
			<ul class="nav">
				
				<li class="dropdown">
					<a href="namespaces.list.html" class="dropdown-toggle" data-toggle="dropdown">Namespaces<b
						class="caret"></b></a>

					<ul class="dropdown-menu ">
						
						<li>
							<a href="BlobUtilities.html">BlobUtilities</a>
						</li>
						
						<li>
							<a href="FileUtilities.html">FileUtilities</a>
						</li>
						
						<li>
							<a href="QueueUtilities.html">QueueUtilities</a>
						</li>
						
						<li>
							<a href="TableUtilities.html">TableUtilities</a>
						</li>
						

					</ul>
				</li>
				
				<li class="dropdown">
					<a href="modules.list.html" class="dropdown-toggle" data-toggle="dropdown">Modules<b
						class="caret"></b></a>

					<ul class="dropdown-menu ">
						
						<li>
							<a href="module-date.html">date</a>
						</li>
						

					</ul>
				</li>
				
				<li class="dropdown">
					<a href="classes.list.html" class="dropdown-toggle" data-toggle="dropdown">Classes<b
						class="caret"></b></a>

					<ul class="dropdown-menu ">
						
						<li>
							<a href="BlobService.html">BlobService</a>
						</li>
						
						<li>
							<a href="ExponentialRetryPolicyFilter.html">ExponentialRetryPolicyFilter</a>
						</li>
						
						<li>
							<a href="FileService.html">FileService</a>
						</li>
						
						<li>
							<a href="LinearRetryPolicyFilter.html">LinearRetryPolicyFilter</a>
						</li>
						
						<li>
							<a href="QueueService.html">QueueService</a>
						</li>
						
						<li>
							<a href="RetryPolicyFilter.html">RetryPolicyFilter</a>
						</li>
						
						<li>
							<a href="TableBatch.html">TableBatch</a>
						</li>
						
						<li>
							<a href="TableQuery.html">TableQuery</a>
						</li>
						
						<li>
							<a href="TableService.html">TableService</a>
						</li>
						

					</ul>
				</li>
				
				<li class="dropdown">
					<a href="global.html" class="dropdown-toggle" data-toggle="dropdown">Global<b
						class="caret"></b></a>

					<ul class="dropdown-menu ">
						
						<li>
							<a href="global.html#createBlobService">createBlobService</a>
						</li>
						
						<li>
							<a href="global.html#createBlobServiceAnonymous">createBlobServiceAnonymous</a>
						</li>
						
						<li>
							<a href="global.html#createBlobServiceWithSas">createBlobServiceWithSas</a>
						</li>
						
						<li>
							<a href="global.html#createFileService">createFileService</a>
						</li>
						
						<li>
							<a href="global.html#createQueueService">createQueueService</a>
						</li>
						
						<li>
							<a href="global.html#createQueueServiceWithSas">createQueueServiceWithSas</a>
						</li>
						
						<li>
							<a href="global.html#createTableService">createTableService</a>
						</li>
						
						<li>
							<a href="global.html#createTableServiceWithSas">createTableServiceWithSas</a>
						</li>
						
						<li>
							<a href="global.html#generateDevelopmentStorageCredendentials">generateDevelopmentStorageCredendentials</a>
						</li>
						

					</ul>
				</li>
				
			</ul>
		</div>
	</div>

	<div class="row-fluid">

		
		<div class="span8">
			
				<div id="main">
					


	
	<span class="page-title">Index</span>
	
	












	
	





    <section class="readme-section">
        <article><h1>Microsoft Azure Storage SDK for Node.js</h1>
<p><a href="http://badge.fury.io/js/azure-storage"><img src="https://badge.fury.io/js/azure-storage.svg" alt="NPM version"></a></p>
<p>This project provides a Node.js package that makes it easy to consume and manage Microsoft Azure Storage Services.</p>
<blockquote>
<p>If you are looking for documentation for the Azure SDK for Node.js, see <a href="http://dl.windowsazure.com/nodedocs/index.html"><a href="http://dl.windowsazure.com/nodedocs/index.html">http://dl.windowsazure.com/nodedocs/index.html</a></a> or visit <a href="https://github.com/Azure/azure-sdk-for-node"><a href="https://github.com/Azure/azure-sdk-for-node">https://github.com/Azure/azure-sdk-for-node</a></a>.</p>
</blockquote>
<h1>Features</h1>
<ul>
<li>Tables<ul>
<li>Create/Delete Tables</li>
<li>Query/Create/Read/Update/Delete Entities</li>
</ul>
</li>
<li>Blobs<ul>
<li>Create/Read/Update/Delete Blobs</li>
</ul>
</li>
<li>Files<ul>
<li>Create/Update/Delete Directories</li>
<li>Create/Read/Update/Delete Files</li>
</ul>
</li>
<li>Queues<ul>
<li>Create/Delete Queues</li>
<li>Insert/Peek Queue Messages</li>
<li>Advanced Queue Operations</li>
</ul>
</li>
</ul>
<h1>Getting Started</h1>
<h2>Install</h2>
<p>npm install azure-storage</p>
<h2>Usage</h2>
<p>var azureStorage = require('azure-storage');</p>
<p>When using the Storage SDK, you must provide connection information for the storage account to use. This can be provided using:</p>
<ul>
<li><p>Environment variables - AZURE_STORAGE_ACCOUNT and AZURE_STORAGE_ACCESS_KEY, or AZURE_STORAGE_CONNECTION_STRING.</p>
</li>
<li><p>Constructors - For example, <code>var tableSvc = azureStorage.createTableService(accountName, accountKey);</code></p>
</li>
</ul>
<h3>Table Storage</h3>
<p>To ensure a table exists, call <strong>createTableIfNotExists</strong>:</p>
<pre><code class="lang-Javascript">var azureStorage = require('azure-storage');
var tableService = azureStorage.createTableService();
tableService.createTableIfNotExists('mytable', function(error, result, response){
  if(!error){
    // result contains true if created; false if already exists
  }
});</code></pre>
<p>A new entity can be added by calling <strong>insertEntity</strong>:</p>
<pre><code class="lang-Javascript">var azureStorage = require('azure-storage');
var tableService = azureStorage.createTableService(),
var entGen = azureStorage.TableUtilities.entityGenerator;
var entity = {     PartitionKey: entGen.String('part2'),
                RowKey: entGen.String('row1'),
                boolValueTrue: entGen.Boolean(true),
                boolValueFalse: entGen.Boolean(false),
                intValue: entGen.Int32(42),
                dateValue: entGen.DateTime(new Date(Date.UTC(2011, 10, 25))),
                complexDateValue: entGen.DateTime(new Date(Date.UTC(2013, 02, 16, 01, 46, 20)))
             };
tableService.insertEntity('mytable',entity, function (error, result, response) {
  if(!error){
    // result contains the ETag for the new entity
  }
});</code></pre>
<p>Instead of creating entities manually, you can use <strong>entityGenerator</strong>:</p>
<pre><code class="lang-Javascript">var azureStorage = require('azure-storage');
var entGen = azureStorage.TableUtilities.entityGenerator;
var task = {
  PartitionKey: entGen.String('hometasks'),
  RowKey: entGen.String('1'),
  description: entGen.String('take out the trash'),
  dueDate: entGen.DateTime(new Date(Date.UTC(2015, 6, 20))),
};</code></pre>
<p>The method <strong>retrieveEntity</strong> can then be used to fetch the entity that was just inserted:</p>
<pre><code class="lang-Javascript">var azureStorage = require('azure-storage');
var tableService = azureStorage.createTableService();
tableService.retrieveEntity('mytable', 'part2', 'row1', function(error, result, response){
  if(!error){
    // result contains the entity
  }
});</code></pre>
<p>Use <strong>TableQuery</strong> to build complex queries:</p>
<pre><code class="lang-Javascript">var azureStorage = require('azure-storage');
var tableService = azureStorage.createTableService();
var query = azureStorage.TableQuery()
            .top(5)
            .where('PartitionKey eq ?', 'part2');

tableSvc.queryEntities('mytable', query, null, function(error, result, response) {
  if(!error) {
    // result.entries contains entities matching the query
  }
});</code></pre>
<h3>Blob Storage</h3>
<p>The <strong>createContainerIfNotExists</strong> method can be used to create a
container in which to store a blob:</p>
<pre><code class="lang-Javascript">var azureStorage = require('azure-storage');
var blobService = azureStorage.createBlobService();
blobService.createContainerIfNotExists('taskcontainer', {publicAccessLevel : 'blob'}, function(error, result, response){
    if(!error){
        // if result = true, container was created.
        // if result = false, container already existed.
    }
});</code></pre>
<p>To upload a file (assuming it is called task1-upload.txt and it is placed in the same folder as the script below), the method <strong>createBlockBlobFromLocalFile</strong> can be used.</p>
<pre><code class="lang-Javascript">var azureStorage = require('azure-storage');
var blobService = azureStorage.createBlobService();

blobService.createBlockBlobFromLocalFile('mycontainer', 'taskblob', 'task1-upload.txt', function(error, result, response){
  if(!error){
    // file uploaded
  }
});</code></pre>
<p>For page blobs, use <strong>createPageBlobFromLocalFile</strong>. There are other methods for uploading blobs also, such as <strong>createBlockBlobFromText</strong> or <strong>createPageBlobFromStream</strong>.</p>
<p>There are also several ways to download block and page blobs. For example, <strong>getBlockBlobToStream</strong> downloads the blob to a stream:</p>
<pre><code class="lang-Javascript">var blobService = azureStorage.createBlobService();
var fs = require('fs');
blobService.getBlockBlobToStream('mycontainer', 'taskblob', fs.createWriteStream('output.txt'), function(error, result, response){
  if(!error) {
    // blob retrieved
  }
});</code></pre>
<p>To create a Shared Access Signature (SAS), use the <strong>generateSharedAccessSignature</strong> method. Additionally you can use the <strong>date</strong> helper functions to easily create a SAS that expires at some point relative to the current time.</p>
<pre><code class="lang-Javascript">var azureStorage = require('azure-storage');
var blobService = azureStorage.createBlobService();


var startDate = new Date();
var expiryDate = new Date(startDate);
expiryDate.setMinutes(startDate.getMinutes() + 100);
startDate.setMinutes(startDate.getMinutes() - 100);

var sharedAccessPolicy = {
    AccessPolicy: {
      Permissions: azureStorage.BlobUtilities.SharedAccessPermissions.READ,
      Start: startDate,
      Expiry: expiryDate
  },
};

var token = blobService.generateSharedAccessSignature(containerName, blobName, sharedAccessPolicy);
var sasUrl = blobService.getUrl(containerName, blobName, token);</code></pre>
<h3>Queue Storage</h3>
<p>The <strong>createQueueIfNotExists</strong> method can be used to ensure a queue exists:</p>
<pre><code class="lang-Javascript">var azureStorage = require('azure-storage');
var queueService = azureStorage.createQueueService();
queueService.createQueueIfNotExists('taskqueue', function(error){
    if(!error){
        // Queue exists
    }
});</code></pre>
<p>The <strong>createMessage</strong> method can then be called to insert the message into the queue:</p>
<pre><code class="lang-Javascript">var queueService = azureStorage.createQueueService();
queueService.createMessage('taskqueue', 'Hello world!', function(error){
    if(!error){
        // Message inserted
    }
});</code></pre>
<p>It is then possible to call the <strong>getMessage</strong> method, process the message and then call <strong>deleteMessage</strong> inside the callback. This two-step process ensures messages don't get lost when they are removed from the queue.</p>
<pre><code class="lang-Javascript">var queueService = azureStorage.createQueueService(),
    queueName = 'taskqueue';
queueService.getMessages(queueName, function(error, serverMessages){
    if(!error){
        // Process the message in less than 30 seconds, the message
        // text is available in serverMessages[0].messagetext

        queueService.deleteMessage(queueName, serverMessages[0].messageid, serverMessages[0].popreceipt, function(error){
            if(!error){
                // Message deleted
            }
        });
    }
});</code></pre>
<h3>File Storage</h3>
<p>The <strong>createShareIfNotExists</strong> method can be used to create a
share in which to store a file or a directory of files:</p>
<pre><code class="lang-Javascript">var azureStorage = require('azure-storage');
var fileService = azureStorage.createFileService();
fileService.createShareIfNotExists('taskshare', function(error, result, response){
    if(!error){
        // if result = true, share was created.
        // if result = false, share already existed.
    }
});</code></pre>
<p>To create a directory, the method <strong>createDirectoryIfNotExists</strong> can be used.</p>
<pre><code class="lang-Javascript">var azureStorage = require('azure-storage');
var fileService = azureStorage.createFileService();

fileService.createDirectoryIfNotExists('taskshare', 'taskdirectory', function(error, result, response){
    if(!error){
        // if result = true, share was created.
        // if result = false, share already existed.
    }
});</code></pre>
<p>To upload a file (assuming it is called task1-upload.txt and it is placed in the same folder as the script below), the method <strong>createFileFromLocalFile</strong> can be used.</p>
<pre><code class="lang-Javascript">var azureStorage = require('azure-storage');
var fileService = azureStorage.createFileService();

fileService.createFileFromLocalFile('taskshare', 'taskdirectory', 'taskfile', 'task1-upload.txt', function(error, result, response){
  if(!error){
    // file uploaded
  }
});</code></pre>
<p>There are other methods for uploading files also, such as <strong>createFileFromText</strong> or <strong>createFileFromStream</strong>.</p>
<p>There are also several ways to download files. For example, <strong>getFileToStream</strong> downloads the file to a stream:</p>
<pre><code class="lang-Javascript">var fileService = azureStorage.createFileService();
var fs = require('fs');
fileService.getFileToStream('taskshare', 'taskdirectory', 'taskfile', fs.createWriteStream('output.txt'), function(error, result, response){
  if(!error) {
    // file retrieved
  }
});</code></pre>
<h2>Code Samples</h2>
<p>How-Tos focused around accomplishing specific tasks are available on the <a href="http://azure.microsoft.com/en-us/develop/nodejs/">Microsoft Azure Node.js Developer Center</a>.</p>
<ul>
<li><p><a href="http://azure.microsoft.com/en-us/documentation/articles/storage-nodejs-how-to-use-blob-storage/">How to use the Blob Service from Node.js</a></p>
</li>
<li><p><a href="http://azure.microsoft.com/en-us/documentation/articles/storage-nodejs-how-to-use-table-storage/">How to use the Table Service from Node.js</a></p>
</li>
<li><p><a href="http://azure.microsoft.com/en-us/documentation/articles/storage-nodejs-how-to-use-queues/">How to use the Queue Service from Node.js</a></p>
</li>
</ul>
<h1>Running Tests</h1>
<p>In order to run the tests, the following environment variables need to be set up:</p>
<p>AZURE_STORAGE_CONNECTION_STRING=&quot;valid storage connection string&quot;</p>
<p>or</p>
<p>AZURE_STORAGE_ACCOUNT=&quot;valid storage account name&quot;</p>
<p>AZURE_STORAGE_ACCESS_KEY=&quot;valid storage account key&quot;</p>
<p>In order to be able to use a proxy like fiddler, an additional environment variable should be set up:</p>
<p>HTTP_PROXY=<a href="http://127.0.0.1:8888">http://127.0.0.1:8888</a></p>
<p>The tests can then be run from the module's root directory using:</p>
<p><code>npm test</code></p>
<h1>Need Help?</h1>
<p>Be sure to check out the Microsoft Azure <a href="http://go.microsoft.com/fwlink/?LinkId=234489">Developer Forums on MSDN</a> if you have trouble with the provided code or use StackOverflow.</p>
<h1>Learn More</h1>
<ul>
<li><a href="http://azure.microsoft.com/en-us/develop/nodejs/">Microsoft Azure Node.js Developer Center</a></li>
<li>[Azure Storage Team Blog] (<a href="http://blogs.msdn.com/b/windowsazurestorage/">http://blogs.msdn.com/b/windowsazurestorage/</a>)</li>
</ul>
<h1>Contribute</h1>
<p>We gladly accept community contributions.</p>
<ul>
<li>Issues: Please report bugs using the Issues section of GitHub</li>
<li>Forums: Interact with the development teams on StackOverflow or the Microsoft Azure Forums</li>
<li>Source Code Contributions: If you would like to become an active contributor to this project please follow the instructions provided in <a href="http://azure.github.com/guidelines.html">Microsoft Azure Projects Contribution Guidelines</a>.</li>
</ul>
<p>For general suggestions about Microsoft Azure please use our <a href="http://feedback.azure.com/forums/34192--general-feedback">UserVoice forum</a>.</p></article>
    </section>







				</div>

				<div class="clearfix"></div>
				<footer>
					
					
		<span class="jsdoc-message">
		Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.2.2</a>
		on 2014-10-30T16:19:32-04:00 using the <a
			href="https://github.com/terryweiss/docstrap">DocStrap template</a>.
		</span>
				</footer>
			</div>

			
			<div class="span3">
				<div id="toc"></div>
			</div>
			
			<br clear="both">
		</div>

	</div>
	<!--<script src="scripts/sunlight.js"></script>-->
	<script src="scripts/docstrap.lib.js"></script>
	<script src="scripts/bootstrap-dropdown.js"></script>
	<script src="scripts/toc.js"></script>

	<script>
		$( function () {
			$( "[id*='$']" ).each( function () {
				var $this = $( this );

				$this.attr( "id", $this.attr( "id" ).replace( "$", "__" ) );
			} );

			$( "#toc" ).toc( {
				anchorName  : function ( i, heading, prefix ) {
					return $( heading ).attr( "id" ) || ( prefix + i );
				},
				selectors   : "h1,h2,h3,h4",
				showAndHide : false,
				scrollTo    : "100px"
			} );

			$( "#toc>ul" ).addClass( "nav nav-pills nav-stacked" );
			$( "#main span[id^='toc']" ).addClass( "toc-shim" );
			$( '.dropdown-toggle' ).dropdown();
//			$( ".tutorial-section pre, .readme-section pre" ).addClass( "sunlight-highlight-javascript" ).addClass( "linenums" );

			$( ".tutorial-section pre, .readme-section pre" ).each( function () {
				var $this = $( this );

				var example = $this.find( "code" );
				exampleText = example.html();
				var lang = /{@lang (.*?)}/.exec( exampleText );
				if ( lang && lang[1] ) {
					exampleText = exampleText.replace( lang[0], "" );
					example.html( exampleText );
					lang = lang[1];
				} else {
					lang = "javascript";
				}

				if ( lang ) {

					$this
						.addClass( "sunlight-highlight-" + lang )
						.addClass( "linenums" )
						.html( example.html() );

				}
			} );

			Sunlight.highlightAll( {
				lineNumbers : true,
				showMenu : true,
				enableDoclinks : true
			} );
		} );
	 </script>



	<!--Navigation and Symbol Display-->
	


	<!--Google Analytics-->
	

</body>
</html>